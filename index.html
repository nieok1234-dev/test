<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Dla Ciebie ‚ù§Ô∏è</title>
<style>
  * { box-sizing: border-box; }
  html,body { height:100%; }
  body {
    margin: 0;
    background: linear-gradient(180deg,#ffd6e8 0%, #ffb6d5 100%);
    overflow: hidden;
    font-family: "Comic Sans MS", "Marker Felt", cursive, sans-serif;
    -webkit-font-smoothing:antialiased;
  }

  /* pages */
  .page { position:absolute; inset:0; display:none; }
  .page.active { display:block; }

  /* falling items */
  .falling {
    position: absolute;
    top: -80px;
    pointer-events: none;
    opacity: 0.9;
    user-select: none;
    transform-origin: center;
    animation: fall linear infinite;
  }
  @keyframes fall {
    to { transform: translateY(120vh) rotate(360deg); }
  }

  /* flowers */
  .flower {
    position:absolute;
    font-size: 24px;
    pointer-events: none;
    animation: float 6s ease-in-out infinite;
  }
  @keyframes float { 50% { transform: translateY(-10px); } }

  /* center heart (used as the "kwadracik" replacement on page 2) */
  .heart-box {
    position: absolute;
    width: 260px;
    height: 240px;
    left: 50%;
    top: 50%;
    transform: translate(-50%,-50%);
    display:flex;
    align-items:center;
    justify-content:center;
    text-align:center;
    color: white;
    transition: 0.6s ease;
    z-index: 5;
  }
  /* heart shape */
  .heart {
    position: relative;
    width: 180px;
    height: 160px;
    background: #ff2d55;
    transform: rotate(-45deg);
    border-radius: 10px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    display:flex;
    align-items:center;
    justify-content:center;
  }
  .heart:before, .heart:after {
    content: "";
    position: absolute;
    width: 180px;
    height: 160px;
    background: #ff2d55;
    border-radius: 50%;
  }
  .heart:before { top: -90px; left: 0; }
  .heart:after  { left: 90px; top: 0; transform: rotate(90deg); }

  .heart-content {
    transform: rotate(45deg);
    width: 140px;
    padding: 10px;
    font-size: 16px;
    line-height: 1.2;
  }

  button.btn {
    margin-top: 12px;
    padding: 10px 14px;
    border-radius: 12px;
    border: none;
    cursor: pointer;
    font-weight: 700;
    font-size: 15px;
  }

  /* Page3 layout */
  .page3-container {
    position:absolute;
    inset:0;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    gap:18px;
    z-index:4;
  }

  .question {
    font-size: 34px;
    color:#6b0532;
    text-shadow: 0 3px 10px rgba(0,0,0,0.12);
    margin-bottom: 6vh;
  }

  .choices {
    position: absolute;
    bottom: 40px;
    left: 50%;
    transform: translateX(-50%);
    display:flex;
    gap: 12px;
    align-items:center;
    z-index:6;
  }
  .choice-tak {
    background: #2ecc71;
    color: white;
    padding: 8px 12px;
    border-radius: 8px;
    font-weight: 900;
    transform-origin: center;
    font-size: 14px;
    cursor: pointer;
    box-shadow: 0 6px 14px rgba(0,0,0,0.12);
    transition: transform 0.15s ease;
  }
  .choice-nie {
    background: #ff3b30;
    color: white;
    padding: 8px 12px;
    border-radius: 8px;
    font-weight: 900;
    font-size: 14px;
    cursor: pointer;
    box-shadow: 0 6px 14px rgba(0,0,0,0.12);
  }

  /* messages inside big heart on page3 */
  .big-heart {
    position: relative;
    width: 320px;
    height: 280px;
    transform: rotate(-45deg);
    background: #ff2d55;
    margin-bottom: 16px;
    border-radius: 12px;
    display:flex;
    align-items:center;
    justify-content:center;
    box-shadow: 0 12px 30px rgba(0,0,0,0.18);
    z-index:5;
  }
  .big-heart:before, .big-heart:after {
    content:"";
    position:absolute;
    width: 320px;
    height: 280px;
    background:#ff2d55;
    border-radius:50%;
  }
  .big-heart:before { top: -170px; left: 0; }
  .big-heart:after  { left: 160px; top: 0; transform: rotate(90deg); }

  .big-heart .inside {
    transform: rotate(45deg);
    color:white;
    text-align:center;
    padding: 10px;
    width:240px;
  }

  .tak-text {
    font-weight: 900;
    letter-spacing: 1px;
    user-select: none;
    cursor: default;
    transition: transform 0.2s linear;
  }

  /* overlay for fullscreen TAK and celebration */
  .overlay {
    position: fixed;
    inset:0;
    display:none;
    align-items:center;
    justify-content:center;
    background: rgba(0,0,0,0.35);
    z-index: 200;
  }
  .overlay.show { display:flex; }

  /* fireworks/hearts */
  .explosion {
    position: absolute;
    inset: 0;
    pointer-events: none;
    overflow: visible;
    z-index: 210;
  }

  .spark {
    position: absolute;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    pointer-events: none;
    opacity: 0.95;
    transform: translate(-50%,-50%);
    animation: fly 1000ms ease-out forwards;
  }
  @keyframes fly {
    to { transform: translate(var(--tx), var(--ty)) scale(0.4); opacity: 0; }
  }

  /* GIF container */
  .cats-gif {
    position: absolute;
    bottom: 40px;
    right: 40px;
    width: 220px;
    height: auto;
    z-index: 220;
    border-radius: 14px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.25);
    overflow: hidden;
    display:none;
  }
  .cats-gif.show { display:block; }

  /* small responsive tweaks */
  @media (max-width:520px){
    .big-heart { width: 260px; height: 220px; }
    .big-heart:before, .big-heart:after { width:260px; height:220px; }
    .heart { width:150px; height:130px; }
  }
</style>
</head>
<body>

  <div id="page1" class="page active"></div>
  <div id="page2" class="page"></div>
  <div id="page3" class="page"></div>

  <!-- celebration overlay -->
  <div id="overlay" class="overlay" aria-hidden="true">
    <div id="explosion" class="explosion"></div>
    <img id="catsGif" class="cats-gif" src="https://media.giphy.com/media/3oEduSbSGpGaRX2Vri/giphy.gif" alt="kotki" />
  </div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const page1 = document.getElementById("page1");
  const page2 = document.getElementById("page2");
  const page3 = document.getElementById("page3");
  const pages = [page1, page2, page3];

  function showPage(n){
    pages.forEach(p => p.classList.remove("active"));
    pages[n].classList.add("active");
  }

  // falling elements generator
  function falling(parent, symbol, count){
    for(let i=0;i<count;i++){
      const el = document.createElement("div");
      el.className = "falling";
      el.textContent = symbol;
      el.style.left = (Math.random()*100) + "vw";
      el.style.fontSize = (12 + Math.random()*30) + "px";
      el.style.animationDuration = (4 + Math.random()*6) + "s";
      el.style.opacity = 0.7 + Math.random()*0.3;
      el.style.transform = `rotate(${Math.random()*360}deg)`;
      el.style.top = (-20 - Math.random()*120) + "px";
      parent.appendChild(el);
      // remove when animation ends (helps memory)
      setTimeout(()=> el.remove(), (parseFloat(el.style.animationDuration)||5)*1000 + 2000);
      // respawn occasionally
      setInterval(()=>{
        if(!document.body.contains(el)) return;
      }, 5000);
    }
  }

  function flowers(parent, emojis, howMany=20){
    for(let i=0;i<howMany;i++){
      const f = document.createElement("div");
      f.className = "flower";
      f.textContent = emojis[Math.floor(Math.random()*emojis.length)];
      f.style.left = (Math.random()*95) + "vw";
      f.style.top = (Math.random()*85) + "vh";
      f.style.fontSize = (16 + Math.random()*28) + "px";
      f.style.opacity = 0.9 - Math.random()*0.4;
      parent.appendChild(f);
    }
  }

  /* ---------- PAGE 1 ---------- */
  falling(page1, "‚ù§Ô∏è", 60);
  flowers(page1, ["üå∏","üå∫","üå∑","üåº"], 18);

  const box1 = document.createElement("div");
  box1.className = "heart-box";
  box1.innerHTML = `
    <div class="heart">
      <div class="heart-content">
        <h2 style="margin:0;font-size:20px">No hej to ja</h2>
        <p style="margin:8px 0 0;font-size:14px">Przygotowa≈Çem co≈õ dla ciebie</p>
        <div style="margin-top:10px">
          <button id="b1" class="btn">to tu masz nacisnƒÖƒá myszko</button>
        </div>
      </div>
    </div>
  `;
  page1.appendChild(box1);

  document.getElementById("b1").addEventListener("click", () => {
    showPage(1);
  });

  /* ---------- PAGE 2 (z serduszkiem zamiast kwadracika) ---------- */
  falling(page2, "‚ù§Ô∏è", 30);
  falling(page2, "‚≠ê", 20);
  flowers(page2, ["üåª","üåπ","üåº","üå∫"], 22);

  // heart that moves with the same logic as previous 'box2'
  const heartWrapper = document.createElement("div");
  heartWrapper.className = "heart-box";
  heartWrapper.style.width = "340px";
  heartWrapper.style.height = "300px";

  heartWrapper.innerHTML = `
    <div class="heart" id="movingHeart">
      <div class="heart-content" id="heartContent">
        <div id="ptext" style="font-size:16px;line-height:1.25">Jeszcze nie tu ale zaraz chcia≈Çbym ciƒô o co≈õ zapytaƒá</div>
        <div style="margin-top:10px">
          <button id="moveBtn" class="btn">teraz tutaj</button>
        </div>
      </div>
    </div>
  `;
  page2.appendChild(heartWrapper);

  const poems = [
    "Lena, Lenka, Lencia ma üíï serce jak bajka ca≈Ça",
    "Lenka to m√≥j ca≈Çy ≈õwiat üíñ",
    "Lencia ‚Äì m√≥j skarb ü•∞"
  ];
  let step = 0;
  const moveBtn = document.getElementById("moveBtn");
  const ptext = document.getElementById("ptext");
  const movingHeart = document.getElementById("movingHeart");
  // initial position values
  heartWrapper.style.left = "50%";
  heartWrapper.style.top = "50%";
  heartWrapper.style.transform = "translate(-50%,-50%)";

  moveBtn.addEventListener("click", () => {
    step++;
    if(step === 1){
      ptext.textContent = poems[Math.floor(Math.random()*poems.length)];
      // move to top-right
      heartWrapper.style.top = "12%";
      heartWrapper.style.left = "80%";
      heartWrapper.style.transform = "translate(-50%,-50%)";
    } else if(step === 2){
      // bottom-left
      heartWrapper.style.top = "78%";
      heartWrapper.style.left = "10%";
      moveBtn.textContent = "oho i co teraz?";
    } else if (step === 3){
      // center
      heartWrapper.style.top = "50%";
      heartWrapper.style.left = "50%";
      moveBtn.textContent = "no dobra ale ostatnia rzecz";
    } else {
      // go to page 3
      showPage(2);
      initPage3(); // prepare page 3 elements when leaving page2
    }
  });

  /* ---------- PAGE 3 ---------- */
  function initPage3(){
    // clear if anything already appended
    page3.innerHTML = "";
    falling(page3, "‚ù§Ô∏è", 40);
    falling(page3, "‚≠ê", 40);
    flowers(page3, ["üå∏","üå∑","üåπ","üå∫","üåº"], 26);

    const container = document.createElement("div");
    container.className = "page3-container";

    container.innerHTML = `
      <div style="height:8vh;"></div>
      <div class="question">czy zostaniesz mojƒÖ walentynkƒÖ?</div>

      <div style="display:flex;align-items:center;justify-content:center;">
        <div class="big-heart" id="bigHeart">
          <div class="inside">
            <div id="heartLines" style="margin-bottom:12px"></div>
            <div class="tak-text" id="takText" style="font-size:28px">TAK!!!</div>
          </div>
        </div>
      </div>

      <div class="choices">
        <div id="takBtn" class="choice-tak" title="TAK">TAKK!!!</div>
        <div id="nieBtn" class="choice-nie" title="NIE">nie</div>
      </div>
    `;

    page3.appendChild(container);

    // interactive logic
    const takText = document.getElementById("takText");
    const nieBtn = document.getElementById("nieBtn");
    const takBtn = document.getElementById("takBtn");
    const heartLines = document.getElementById("heartLines");
    const bigHeart = document.getElementById("bigHeart");

    let nieClicks = 0;
    const messages = ["ale jak to", "aha?", "üòÖ", "no wezzz"];
    let msgIndex = 0;
    let baseScale = 1;

    // initialize takBtn small and disabled for clicking until expanded fully
    takBtn.style.transform = "scale(0.8)";
    takBtn.style.pointerEvents = "none";
    takBtn.style.opacity = "0.95";

    function updateTakScale() {
      // Each click increases scale so that after 8 clicks TAK fills screen
      // We'll increase by factor so that after 8 clicks font-size becomes huge.
      // Use incremental scale multiplier:
      baseScale = 1 + (nieClicks / 1.6); // tuned so 8 clicks ~ scale ~6
      takText.style.transform = `scale(${baseScale})`;
      // also scale the green button slightly to match
      takBtn.style.transform = `scale(${0.8 + nieClicks*0.12})`;
    }

    nieBtn.addEventListener("click", () => {
      nieClicks++;
      // add message in heart (sequence) ‚Äî append new line
      const m = messages[msgIndex] || messages[messages.length-1];
      const span = document.createElement("div");
      span.textContent = m;
      span.style.fontSize = "14px";
      span.style.margin = "6px 0";
      heartLines.appendChild(span);
      // advance msgIndex but don't overflow
      msgIndex = (msgIndex + 1) % messages.length;

      // enlarge TAK text
      updateTakScale();

      // subtle shake for "nie" button
      nieBtn.animate([
        { transform: 'translateY(0)' },
        { transform: 'translateY(-8px)' },
        { transform: 'translateY(0)' }
      ], { duration: 260, easing: 'ease-out' });

      // if clicked enough times (>=8) make TAK full-screen clickable
      if(nieClicks >= 8){
        // make TAK take entire screen visually
        takText.style.transition = "transform 300ms ease, font-size 300ms ease";
        takText.style.transform = "scale(16)";
        // bring overlay for only TAK clickable
        takBtn.style.pointerEvents = "auto";
        takBtn.style.background = "#1abc9c";
        // make it obvious it's the only clickable: hide NIE
        nieBtn.style.pointerEvents = "none";
        nieBtn.style.opacity = "0.45";
        // move takBtn to center and enlarge it visually to be full screen
        takBtn.style.position = "fixed";
        takBtn.style.left = "50%";
        takBtn.style.top = "50%";
        takBtn.style.transform = "translate(-50%,-50%) scale(20)";
        takBtn.style.zIndex = "250";
        takBtn.style.padding = "40px 60px";
        takBtn.style.borderRadius = "0";
        takBtn.style.fontSize = "110px";
        takBtn.textContent = "TAK!!!";
        // show cats gif preview
        document.getElementById("catsGif").classList.add("show");
      }
    });

    // When final TAK button clicked after it filled screen -> celebration
    takBtn.addEventListener("click", () => {
      if(nieClicks < 8) {
        // before full, do a cute pulse to signal it's not final
        takBtn.animate([
          { transform: takBtn.style.transform },
          { transform: 'scale(1.15)' },
          { transform: takBtn.style.transform }
        ], { duration: 380, easing: 'cubic-bezier(.2,.8,.2,1)'});
        return;
      }
      // final celebration
      triggerCelebration();
    });

    // ensure bigHeart text rotates back to normal on clicks
    bigHeart.addEventListener("click", () => {
      // just a tiny pulse
      bigHeart.animate([
        { transform: 'rotate(-45deg) scale(1)' },
        { transform: 'rotate(-45deg) scale(0.95)' },
        { transform: 'rotate(-45deg) scale(1)' }
      ], { duration: 280 });
    });
  } // end initPage3

  /* ---------- Celebration logic ---------- */
  function triggerCelebration(){
    const overlay = document.getElementById("overlay");
    const explosion = document.getElementById("explosion");
    const gif = document.getElementById("catsGif");
    overlay.classList.add("show");
    gif.classList.add("show");

    // create many sparks (hearts & circles)
    const colors = ["#ff2d55","#ff9aa2","#ffd166","#ff6b6b","#ff3b30","#ffd6e8"];
    const num = 60;
    for(let i=0;i<num;i++){
      const s = document.createElement("div");
      s.className = "spark";
      // 50% hearts, 50% dots
      if(Math.random() < 0.5){
        s.style.background = colors[Math.floor(Math.random()*colors.length)];
        s.style.width = s.style.height = (8 + Math.random()*18) + "px";
        s.style.borderRadius = "50%";
      } else {
        s.textContent = "‚ù§Ô∏è";
        s.style.fontSize = (10 + Math.random()*22) + "px";
        s.style.width = s.style.height = "auto";
        s.style.lineHeight = "1";
        s.style.padding = "2px";
        s.style.background = "transparent";
      }
      // start at center of screen
      const cx = window.innerWidth / 2;
      const cy = window.innerHeight / 2;
      s.style.left = (cx + (Math.random()*40-20)) + "px";
      s.style.top = (cy + (Math.random()*40-20)) + "px";

      // random target translation
      const angle = Math.random()*Math.PI*2;
      const radius = 120 + Math.random()*360;
      const tx = Math.cos(angle) * radius + "px";
      const ty = Math.sin(angle) * radius + "px";
      s.style.setProperty("--tx", tx);
      s.style.setProperty("--ty", ty);
      s.style.opacity = 1;
      s.style.zIndex = 220 + Math.floor(Math.random()*80);

      explosion.appendChild(s);

      // remove after animation
      setTimeout(()=> s.remove(), 1400 + Math.random()*800);
    }

    // small additional heart rain
    for(let j=0;j<30;j++){
      const h = document.createElement("div");
      h.className = "falling";
      h.textContent = "üíñ";
      h.style.left = Math.random()*100 + "vw";
      h.style.fontSize = 18 + Math.random()*30 + "px";
      h.style.animationDuration = 1.2 + Math.random()*2 + "s";
      h.style.top = (-20 - Math.random()*120) + "px";
      overlay.appendChild(h);
      setTimeout(()=> h.remove(), 3000);
    }

    // small screen flash
    const flash = document.createElement("div");
    flash.style.position = "fixed";
    flash.style.inset = 0;
    flash.style.background = "radial-gradient(circle at center, rgba(255,255,255,0.95), rgba(255,255,255,0.2) 40%, transparent 60%)";
    flash.style.zIndex = 260;
    flash.style.pointerEvents = "none";
    document.body.appendChild(flash);
    setTimeout(()=> flash.remove(), 420);

    // optionally play a little sound (if allowed) ‚Äî don't force autoplay (commented)
    // let audio = new Audio('path/to/celebration-sound.mp3'); audio.play();

    // after some time, keep GIF visible and overlay allows clicking to close on background
    overlay.addEventListener("click", (e) => {
      if(e.target === overlay) {
        overlay.classList.remove("show");
        document.getElementById("explosion").innerHTML = "";
        document.getElementById("catsGif").classList.remove("show");
      }
    }, { once: true });
  }

  // kick off background periodic falling to keep pages lively
  setInterval(()=> falling(document.querySelector(".page.active") || page1, ["‚ù§Ô∏è","‚≠ê"][Math.floor(Math.random()*2)], 6), 1200);

  // Prepare page transitions: index mapping
  // page indexes: 0 -> page1, 1 -> page2, 2 -> page3
  // When we switched from page2 to page3 earlier we called initPage3() that shows page index 2
  // But we must map showPage(2) to page3 (we used earlier showPage(2) in step result)
  // Because page indexes are [page1,page2,page3] -> showPage(2) => page3. OK.

  // NOTE: initial flow: page1 -> clicking b1 -> page2 -> clicking moveBtn enough -> showPage(2)
  // But we changed showPage indexes: earlier b1 showed page2, now b1 shows page2 already. step path done.

  // For safety, ensure page3 is initialized if user navigates directly
  // We'll lazily init page3 when first activated via MutationObserver or when user lands on it:
  const observer = new MutationObserver(mutations => {
    mutations.forEach(m => {
      if(m.attributeName === 'class') {
        const target = m.target;
        if(target === page3 && target.classList.contains('active')) {
          // init page3 only once
          if(!page3.dataset.init) {
            page3.dataset.init = "1";
            initPage3();
          }
        }
      }
    });
  });
  observer.observe(page3, { attributes: true });

}); // DOMContentLoaded end
</script>

</body>
</html>

