<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Dla Ciebie ‚ù§Ô∏è</title>
<style>
  * { box-sizing: border-box; }
  html,body { height:100%; }
  body {
    margin: 0;
    /* ciemniejszy r√≥≈ºowy gradient */
    background: linear-gradient(180deg,#ff6fa8 0%, #ff2d71 100%);
    overflow: hidden;
    font-family: "Comic Sans MS", "Marker Felt", cursive, sans-serif;
    -webkit-font-smoothing:antialiased;
  }

  .page { position:absolute; inset:0; display:none; }
  .page.active { display:block; }

  .falling {
    position: absolute;
    top: -80px;
    pointer-events: none;
    opacity: 0.9;
    user-select: none;
    transform-origin: center;
    animation: fall linear infinite;
  }
  @keyframes fall {
    to { transform: translateY(120vh) rotate(360deg); }
  }

  .flower {
    position:absolute;
    font-size: 24px;
    pointer-events: none;
    animation: float 6s ease-in-out infinite;
  }
  @keyframes float { 50% { transform: translateY(-10px); } }

  .heart-box {
    position: absolute;
    width: 260px;
    height: 240px;
    left: 50%;
    top: 50%;
    transform: translate(-50%,-50%);
    display:flex;
    align-items:center;
    justify-content:center;
    text-align:center;
    color: white;
    transition: 0.6s ease;
    z-index: 5;
  }

  /* serce: pseudo-elementy mniejsze i pod spodem (z-index) */
  .heart {
    position: relative;
    width: 180px;
    height: 160px;
    background: #ff2d55;
    transform: rotate(-45deg);
    border-radius: 10px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    display:flex;
    align-items:center;
    justify-content:center;
    overflow: visible;
  }
  .heart:before, .heart:after {
    content: "";
    position: absolute;
    width: 60%;
    height: 60%;
    background: #ff2d55;
    border-radius: 50%;
    z-index: 0; /* poni≈ºej tre≈õci */
  }
  .heart:before { top: -28%; left: 0%; }
  .heart:after  { left: 40%; top: 0%; transform: rotate(90deg); }

  .heart-content {
    transform: rotate(45deg);
    width: 140px;
    padding: 10px;
    font-size: 16px;
    line-height: 1.2;
    z-index: 2; /* pewnie nad pseudo-elementami */
    position: relative;
  }

  button.btn {
    margin-top: 12px;
    padding: 10px 14px;
    border-radius: 12px;
    border: none;
    cursor: pointer;
    font-weight: 700;
    font-size: 15px;
  }

  .page3-container {
    position:absolute;
    inset:0;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    gap:18px;
    z-index:4;
  }

  .question {
    font-size: 34px;
    color:#6b0532;
    text-shadow: 0 3px 10px rgba(0,0,0,0.12);
    margin-bottom: 6vh;
  }

  .choices {
    position: absolute;
    bottom: 40px;
    left: 50%;
    transform: translateX(-50%);
    display:flex;
    gap: 12px;
    align-items:center;
    z-index:6;
  }
  .choice-tak {
    background: #2ecc71;
    color: white;
    padding: 8px 12px;
    border-radius: 8px;
    font-weight: 900;
    transform-origin: center;
    font-size: 14px;
    cursor: pointer;
    box-shadow: 0 6px 14px rgba(0,0,0,0.12);
    transition: transform 200ms ease;
  }
  .choice-nie {
    background: #ff3b30;
    color: white;
    padding: 8px 12px;
    border-radius: 8px;
    font-weight: 900;
    font-size: 14px;
    cursor: pointer;
    box-shadow: 0 6px 14px rgba(0,0,0,0.12);
  }

  /* du≈ºe serce na stronie 3 */
  .big-heart {
    position: relative;
    width: 320px;
    height: 280px;
    transform: rotate(-45deg);
    background: #ff2d55;
    margin-bottom: 16px;
    border-radius: 12px;
    display:flex;
    align-items:center;
    justify-content:center;
    box-shadow: 0 12px 30px rgba(0,0,0,0.18);
    z-index:5;
    overflow: visible;
  }
  .big-heart:before, .big-heart:after {
    content:"";
    position:absolute;
    width: 60%;
    height: 60%;
    background:#ff2d55;
    border-radius:50%;
    z-index:0;
  }
  .big-heart:before { top: -28%; left: 0%; }
  .big-heart:after  { left: 40%; top: 0%; transform: rotate(90deg); }

  .big-heart .inside {
    transform: rotate(45deg);
    color:white;
    text-align:center;
    padding: 10px;
    width:240px;
    z-index:2;
  }

  .tak-text {
    font-weight: 900;
    letter-spacing: 1px;
    user-select: none;
    cursor: default;
    transition: transform 220ms ease;
    transform-origin: center;
  }

  .overlay {
    position: fixed;
    inset:0;
    display:none;
    align-items:center;
    justify-content:center;
    background: rgba(0,0,0,0.35);
    z-index: 200;
  }
  .overlay.show { display:flex; }

  .explosion { position: absolute; inset:0; pointer-events:none; overflow:visible; z-index:210; }

  .spark {
    position: absolute;
    width: 12px;
    height: 12px;
    border-radius: 50%;
    pointer-events: none;
    opacity: 0.95;
    transform: translate(-50%,-50%);
    animation: fly 1000ms ease-out forwards;
  }
  @keyframes fly {
    to { transform: translate(var(--tx), var(--ty)) scale(0.4); opacity: 0; }
  }

  /* GIF centrowany i du≈ºy */
  .cats-gif {
    position: fixed;
    left: 50%;
    top: 50%;
    transform: translate(-50%,-50%);
    width: 640px;
    height: auto;
    z-index: 220;
    border-radius: 14px;
    box-shadow: 0 20px 50px rgba(0,0,0,0.35);
    overflow: hidden;
    display:none;
    background: white;
  }
  .cats-gif.show { display:block; }

  @media (max-width:720px){
    .cats-gif { width: 90vw; }
    .big-heart { width: 260px; height: 220px; }
  }
</style>
</head>
<body>

  <div id="page1" class="page active"></div>
  <div id="page2" class="page"></div>
  <div id="page3" class="page"></div>

  <div id="overlay" class="overlay" aria-hidden="true">
    <div id="explosion" class="explosion"></div>
    <img id="catsGif" class="cats-gif" src="https://media.giphy.com/media/MDJ9IbxxvDUQM/giphy.gif" alt="szczƒô≈õliwe koty skaczƒÖce" />
  </div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  const page1 = document.getElementById("page1");
  const page2 = document.getElementById("page2");
  const page3 = document.getElementById("page3");
  const pages = [page1, page2, page3];

  function showPage(n){
    pages.forEach(p => p.classList.remove("active"));
    pages[n].classList.add("active");
  }

  function falling(parent, symbol, count){
    for(let i=0;i<count;i++){
      const el = document.createElement("div");
      el.className = "falling";
      el.textContent = symbol;
      el.style.left = (Math.random()*100) + "vw";
      el.style.fontSize = (12 + Math.random()*30) + "px";
      el.style.animationDuration = (4 + Math.random()*6) + "s";
      el.style.opacity = 0.7 + Math.random()*0.3;
      el.style.transform = `rotate(${Math.random()*360}deg)`;
      el.style.top = (-20 - Math.random()*120) + "px";
      parent.appendChild(el);
      setTimeout(()=> el.remove(), (parseFloat(el.style.animationDuration)||5)*1000 + 2000);
    }
  }

  function flowers(parent, emojis, howMany=20){
    for(let i=0;i<howMany;i++){
      const f = document.createElement("div");
      f.className = "flower";
      f.textContent = emojis[Math.floor(Math.random()*emojis.length)];
      f.style.left = (Math.random()*95) + "vw";
      f.style.top = (Math.random()*85) + "vh";
      f.style.fontSize = (16 + Math.random()*28) + "px";
      f.style.opacity = 0.9 - Math.random()*0.4;
      parent.appendChild(f);
    }
  }

  /* PAGE 1 */
  falling(page1, "‚ù§Ô∏è", 60);
  flowers(page1, ["üå∏","üå∫","üå∑","üåº"], 18);
  const box1 = document.createElement("div");
  box1.className = "heart-box";
  box1.innerHTML = `
    <div class="heart">
      <div class="heart-content">
        <h2 style="margin:0;font-size:20px">No hej to ja</h2>
        <p style="margin:8px 0 0;font-size:14px">Przygotowa≈Çem co≈õ dla ciebie</p>
        <div style="margin-top:10px">
          <button id="b1" class="btn">to tu masz nacisnƒÖƒá myszko</button>
        </div>
      </div>
    </div>
  `;
  page1.appendChild(box1);
  document.getElementById("b1").addEventListener("click", () => showPage(1));

  /* PAGE 2 */
  falling(page2, "‚ù§Ô∏è", 30);
  falling(page2, "‚≠ê", 20);
  flowers(page2, ["üåª","üåπ","üåº","üå∫"], 22);

  const heartWrapper = document.createElement("div");
  heartWrapper.className = "heart-box";
  heartWrapper.style.width = "340px";
  heartWrapper.style.height = "300px";
  heartWrapper.innerHTML = `
    <div class="heart" id="movingHeart">
      <div class="heart-content" id="heartContent">
        <div id="ptext" style="font-size:16px;line-height:1.25">Jeszcze nie tu ale zaraz chcia≈Çbym ciƒô o co≈õ zapytaƒá</div>
        <div style="margin-top:10px">
          <button id="moveBtn" class="btn">teraz tutaj</button>
        </div>
      </div>
    </div>
  `;
  page2.appendChild(heartWrapper);

  // usunƒÖ≈Çem wierszyki o Lence ‚Äî wiƒôc po pierwszym klikniƒôciu tekst zostaje BEZ ZMIANY, tylko przesuwa siƒô
  let step = 0;
  const moveBtn = document.getElementById("moveBtn");
  const ptext = document.getElementById("ptext");

  heartWrapper.style.left = "50%";
  heartWrapper.style.top = "50%";
  heartWrapper.style.transform = "translate(-50%,-50%)";

  moveBtn.addEventListener("click", () => {
    step++;
    if(step === 1){
      // nie zmieniamy tekstu (usu≈Ñ wierszyki o Lenie) ‚Äî tylko przesuwamy
      heartWrapper.style.top = "12%";
      heartWrapper.style.left = "80%";
      heartWrapper.style.transform = "translate(-50%,-50%)";
    } else if(step === 2){
      heartWrapper.style.top = "78%";
      heartWrapper.style.left = "10%";
      moveBtn.textContent = "oho i co teraz?";
    } else if (step === 3){
      heartWrapper.style.top = "50%";
      heartWrapper.style.left = "50%";
      moveBtn.textContent = "no dobra ale ostatnia rzecz";
    } else {
      // przejd≈∫ do strony 3 i jƒÖ zainicjuj
      showPage(2);
      initPage3();
    }
  });

  /* PAGE 3 init (lazy) */
  function initPage3(){
    page3.innerHTML = "";
    falling(page3, "‚ù§Ô∏è", 40);
    falling(page3, "‚≠ê", 40);
    flowers(page3, ["üå∏","üå∑","üåπ","üå∫","üåº"], 26);

    const container = document.createElement("div");
    container.className = "page3-container";
    container.innerHTML = `
      <div style="height:8vh;"></div>
      <div class="question">czy zostaniesz mojƒÖ walentynkƒÖ?</div>
      <div style="display:flex;align-items:center;justify-content:center;">
        <div class="big-heart" id="bigHeart">
          <div class="inside">
            <div id="heartLines" style="margin-bottom:12px"></div>
            <div class="tak-text" id="takText" style="font-size:28px; transform-origin:center;">TAK!!!</div>
          </div>
        </div>
      </div>
      <div class="choices">
        <div id="takBtn" class="choice-tak" title="TAK">TAKK!!!</div>
        <div id="nieBtn" class="choice-nie" title="NIE">nie</div>
      </div>
    `;
    page3.appendChild(container);

    const takText = document.getElementById("takText");
    const nieBtn = document.getElementById("nieBtn");
    const takBtn = document.getElementById("takBtn");
    const heartLines = document.getElementById("heartLines");
    const bigHeart = document.getElementById("bigHeart");

    let nieClicks = 0;
    const messages = ["ale jak to", "aha?", "üòÖ", "no wezzz"];
    let msgIndex = 0;

    // ustawienia skali: r√≥wnomierny przyrost ‚Äî po 8 klikniƒôciach napis powinien wype≈Çniƒá ekran
    const INITIAL_SCALE = 1;
    const FINAL_SCALE = 16; // docelowa skala (du≈ºa, by wype≈Çniƒá ekran)
    const STEPS = 8;
    const STEP_INC = (FINAL_SCALE - INITIAL_SCALE) / STEPS;

    // poczƒÖtkowo przycisk "TAK" dzia≈Ça (mo≈ºna kliknƒÖƒá natychmiast) ‚Äî ale ma mniejszƒÖ skalƒô wizualnƒÖ
    takBtn.style.transform = "scale(0.95)";
    takBtn.style.transition = "transform 220ms ease";

    nieBtn.addEventListener("click", () => {
      nieClicks++;
      // dodaj liniƒô tekstu w big-heart (kolejno z tablicy messages)
      const m = messages[msgIndex] || messages[messages.length - 1];
      const span = document.createElement("div");
      span.textContent = m;
      span.style.fontSize = "14px";
      span.style.margin = "6px 0";
      heartLines.appendChild(span);
      msgIndex = Math.min(msgIndex + 1, messages.length - 1);

      // r√≥wnomierny wzrost: przyrost sta≈Çy
      const newScale = INITIAL_SCALE + STEP_INC * nieClicks;
      takText.style.transform = `scale(${newScale})`;

      // powiƒôkszaj te≈º zielony przycisk wizualnie, ≈ºeby efekt by≈Ç czytelny
      takBtn.style.transform = `scale(${0.95 + nieClicks * 0.18})`;

      // animacja przycisku NIE
      nieBtn.animate([
        { transform: 'translateY(0)' },
        { transform: 'translateY(-8px)' },
        { transform: 'translateY(0)' }
      ], { duration: 240, easing: 'ease-out' });

      // gdy osiƒÖgniƒôto 8 klikniƒôƒá ‚Äî zr√≥b stopniowe przej≈õcie do trybu "TAK pe≈Çen ekran"
      if(nieClicks >= STEPS){
        // delikatna p≈Çynna transformacja do pe≈Çnego ekranu
        takText.style.transition = "transform 450ms cubic-bezier(.2,.9,.2,1)";
        // ustaw ogromnƒÖ skalƒô i styl tak, ≈ºeby zajƒÖ≈Ç ekran stopniowo (ju≈º ro≈õnie r√≥wnomiernie).
        takText.style.transform = `scale(${FINAL_SCALE})`;

        // zmieniamy zielony przycisk tak, by zajƒÖ≈Ç ≈õrodek i by≈Ç jedynym aktywnym elementem
        takBtn.style.position = "fixed";
        takBtn.style.left = "50%";
        takBtn.style.top = "50%";
        takBtn.style.transform = "translate(-50%,-50%) scale(20)";
        takBtn.style.zIndex = "250";
        takBtn.style.padding = "40px 60px";
        takBtn.style.borderRadius = "0";
        takBtn.style.fontSize = "110px";
        takBtn.style.pointerEvents = "auto";
        takBtn.textContent = "TAK!!!";
        // unie≈õ bigHeart wizualnie
        bigHeart.style.zIndex = "240";

        // zredukuj widoczno≈õƒá przycisku NIE (ju≈º nieklikalny)
        nieBtn.style.pointerEvents = "none";
        nieBtn.style.opacity = "0.45";

        // poka≈º GIF na ≈õrodku (ale nie od razu - po klikniƒôciu TAK)
        document.getElementById("catsGif").classList.add("show");
      }
    });

    // klikniƒôcie TAK ‚Äî je≈õli nieClicks < 8 -> natychmiastowa celebracja; je≈õli >=8 to finalizacja ju≈º wcze≈õniej
    takBtn.addEventListener("click", () => {
      if(nieClicks < STEPS){
        triggerCelebration(true); // natychmiast
        return;
      }
      // je≈õli ju≈º by≈Ç tryb pe≈Çnoekranowy, te≈º celebrujemy
      triggerCelebration(false);
    });

    bigHeart.addEventListener("click", () => {
      bigHeart.animate([
        { transform: 'rotate(-45deg) scale(1)' },
        { transform: 'rotate(-45deg) scale(0.95)' },
        { transform: 'rotate(-45deg) scale(1)' }
      ], { duration: 280 });
    });
  } // initPage3 end

  /* Celebration function
     if forceCenterGif == true -> center & enlarge gif immediately (for case "click TAK immediately")
  */
  function triggerCelebration(forceCenterGif = false){
    const overlay = document.getElementById("overlay");
    const explosion = document.getElementById("explosion");
    const gif = document.getElementById("catsGif");

    overlay.classList.add("show");

    // wyczy≈õƒá poprzednie iskierki
    explosion.innerHTML = "";

    // stw√≥rz du≈ºo "iskier" i serduszek
    const colors = ["#ff2d55","#ff9aa2","#ffd166","#ff6b6b","#ff3b30","#ffd6e8"];
    const num = 70;
    const cx = window.innerWidth / 2;
    const cy = window.innerHeight / 2;
    for(let i=0;i<num;i++){
      const s = document.createElement("div");
      s.className = "spark";
      if(Math.random() < 0.55){
        s.style.background = colors[Math.floor(Math.random()*colors.length)];
        s.style.width = s.style.height = (8 + Math.random()*18) + "px";
        s.style.borderRadius = "50%";
      } else {
        s.textContent = "‚ù§Ô∏è";
        s.style.fontSize = (10 + Math.random()*22) + "px";
        s.style.width = s.style.height = "auto";
        s.style.lineHeight = "1";
        s.style.padding = "2px";
        s.style.background = "transparent";
      }
      // start w centrum
      s.style.left = (cx + (Math.random()*40-20)) + "px";
      s.style.top = (cy + (Math.random()*40-20)) + "px";
      const angle = Math.random()*Math.PI*2;
      const radius = 120 + Math.random()*420;
      const tx = Math.cos(angle) * radius + "px";
      const ty = Math.sin(angle) * radius + "px";
      s.style.setProperty("--tx", tx);
      s.style.setProperty("--ty", ty);
      s.style.opacity = 1;
      s.style.zIndex = 220 + Math.floor(Math.random()*80);
      explosion.appendChild(s);
      setTimeout(()=> s.remove(), 1400 + Math.random()*900);
    }

    // dodatkowy spad serduszek na overlay
    for(let j=0;j<30;j++){
      const h = document.createElement("div");
      h.className = "falling";
      h.textContent = "üíñ";
      h.style.left = Math.random()*100 + "vw";
      h.style.fontSize = 18 + Math.random()*30 + "px";
      h.style.animationDuration = 1.2 + Math.random()*2 + "s";
      h.style.top = (-20 - Math.random()*120) + "px";
      overlay.appendChild(h);
      setTimeout(()=> h.remove(), 3000);
    }

    // flash
    const flash = document.createElement("div");
    flash.style.position = "fixed";
    flash.style.inset = 0;
    flash.style.background = "radial-gradient(circle at center, rgba(255,255,255,0.95), rgba(255,255,255,0.2) 40%, transparent 60%)";
    flash.style.zIndex = 260;
    flash.style.pointerEvents = "none";
    document.body.appendChild(flash);
    setTimeout(()=> flash.remove(), 420);

    // poka≈º GIF kotk√≥w na ≈õrodku i do≈õƒá du≈ºy
    gif.classList.add("show");
    gif.style.width = Math.min(window.innerWidth * 0.8, 800) + "px";

    // klikniƒôcie poza GIF zamyka overlay
    overlay.addEventListener("click", (e) => {
      if(e.target === overlay) {
        overlay.classList.remove("show");
        explosion.innerHTML = "";
        gif.classList.remove("show");
      }
    }, { once: true });
  }

  // ciƒÖg≈Çe drobne spadanie na aktywnej stronie
  setInterval(()=> {
    const active = document.querySelector(".page.active") || page1;
    falling(active, Math.random() < 0.5 ? "‚ù§Ô∏è" : "‚≠ê", 4);
  }, 1400);

  // Lazy init strony 3 je≈õli kto≈õ przejdzie
  const observer = new MutationObserver(mutations => {
    mutations.forEach(m => {
      if(m.attributeName === 'class') {
        const target = m.target;
        if(target === page3 && target.classList.contains('active')) {
          if(!page3.dataset.init) {
            page3.dataset.init = "1";
            initPage3();
          }
        }
      }
    });
  });
  observer.observe(page3, { attributes: true });

}); // DOMContentLoaded
</script>

</body>
</html>

